# V2.5 QA Matrix (Weekly Cadence + Review Modes)

## Scope

Validate V2.5 features:

- Daily mode resolver (`new_day`, `light_review`, `deep_consolidation`, `milestone`)
- Micro-review injection
- Spaced reinforcement checkpoints
- Milestone recording flow (Day 30/60/90)
- Review adherence metrics + 70/30 guardrail message

---

## Environment

- Platforms: Android + iOS (real device preferred)
- Build: latest dev/release-candidate build with `days.json` 1..90
- Reset app local storage before each major scenario set

---

## Test Data Setup

Use seeded/local progress states to force each mode:

1. `new_day`: weekday (Mon-Fri), non-milestone day
2. `light_review`: Saturday
3. `deep_consolidation`: Sunday
4. `milestone`: day 30 or 60 or 90
5. reinforcement pending: `currentDay` >= checkpoint day and checkpoint not completed
6. micro-review eligible pool: include SRS cards at least 30 days old

---

## Mode Matrix

| Case ID | Current Day | Date (Local) | Expected Mode | Expected Pre-Flow |
|---|---:|---|---|---|
| M1 | 21 | Monday | `new_day` | Micro-review appears |
| M2 | 22 | Saturday | `light_review` | Light review runner starts |
| M3 | 23 | Sunday | `deep_consolidation` | Deep consolidation runner starts |
| M4 | 30 | Any | `milestone` | Milestone runner starts |

Pass criteria:

- Home "Today’s Plan" mode matches expected mode.
- Start CTA label and target runner match expected mode.
- Session route params reflect resolved mode.

---

## Transition Matrix

| Case ID | From | Trigger | Expected To |
|---|---|---|---|
| T1 | `new_day` micro-review | Tap `Start Main Session` | Main 7-section session |
| T2 | `light_review` block 1 | Timer ends / Next | Block 2 |
| T3 | `light_review` block 2 | Timer ends / Next | Block 3 |
| T4 | `light_review` block 3 | Timer ends / Finish | Light Review Complete |
| T5 | `deep_consolidation` block 1 | Timer ends / Next | Block 2 |
| T6 | `deep_consolidation` block 2 | Timer ends / Next | Block 3 |
| T7 | `deep_consolidation` block 3 | Timer ends / Finish | Deep Consolidation Complete |
| T8 | `milestone` | Timer reaches `00:00` + Finish | Milestone Complete |

Pass criteria:

- Blocks render in correct order.
- Timer windows follow configured durations.
- Completion screens appear and return to Home.

---

## Resume / Start-Over Scenarios

| Case ID | Mode | Action | Expected Result |
|---|---|---|---|
| R1 | `new_day` | Close mid-session | Home shows continue option |
| R2 | `light_review` | Close on block 2 | Resume restores block index + timer |
| R3 | `deep_consolidation` | Close on block 2 | Resume restores block index + timer |
| R4 | `milestone` | Close mid-recording/timer | Resume restores milestone timer |
| R5 | any | Tap Start Over and confirm | Draft cleared; mode restarts from beginning |

Pass criteria:

- Resume always returns to same mode/day and saved position.
- Start Over clears in-progress state and begins fresh flow.

---

## Reinforcement Checkpoints

| Case ID | Progress State | Expected |
|---|---|---|
| S1 | Checkpoint due and not completed | Home/Session surfaces reinforcement day |
| S2 | New-day session completed with due checkpoint | Reinforcement marked completed |
| S3 | Missed checkpoint (current day > checkpoint) | Checkpoint remains pending until completion |

Pass criteria:

- `reinforcementReviewDay` / checkpoint mapping is correct.
- Offered/completed reinforcement tracking updates as expected.

---

## Milestone Recording

| Case ID | Day | Expected |
|---|---:|---|
| MS1 | 30 | Milestone prompt appears |
| MS2 | 60 | Milestone prompt appears |
| MS3 | 90 | Milestone prompt appears |
| MS4 | any milestone | Can record, stop, replay current |
| MS5 | day 60/90 with previous data | Previous milestone list visible and playable |

Pass criteria:

- Milestone recordings stored with `kind = milestone`.
- Finish button remains disabled until 10-min timer completes.

---

## Metrics & Analytics Validation

Validate local progress data and analytics events:

- Completion counts by mode increment correctly:
  - `new_day`, `light_review`, `deep_consolidation`, `milestone`
- Micro-review shown/completed dates recorded
- Reinforcement offered/completed checkpoint lists updated
- Events emitted:
  - `review_mode_completed`
  - `micro_review_completed`
  - `reinforcement_completed`

Payload safety:

- No raw audio bytes
- No transcript text

---

## Guardrail Validation (70/30)

| Case ID | Setup | Expected Message |
|---|---|---|
| G1 | Reinforcement ratio < 20% | "Review is below 20%..." |
| G2 | Reinforcement ratio > 30% | "Review is above 30%..." |
| G3 | Reinforcement ratio 20–30% | No guardrail warning |

Pass criteria:

- Message is non-blocking.
- Start/continue actions remain enabled.

---

## Release Sign-Off Checklist

- [ ] Android pass for all mode flows
- [ ] iOS pass for all mode flows
- [ ] Resume/start-over pass for all modes
- [ ] Reinforcement checkpoint behavior verified
- [ ] Milestone record/replay verified (current + previous)
- [ ] Progress metrics persisted correctly
- [ ] Analytics events verified with safe payloads
- [ ] 70/30 guardrail behavior verified
- [ ] No blocker/high-severity regressions

Sign-off:

- QA Owner: ____________________
- Engineering Owner: ____________________
- Date: ____________________
